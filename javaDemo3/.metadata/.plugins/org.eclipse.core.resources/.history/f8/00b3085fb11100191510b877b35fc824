import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.RandomAccessFile;

/* RandomAccessFile */
public class demo89 {
	public static void main(String[] args) throws IOException {
/* Java 输出流中功能最丰富的文件内容访问类 */
		File out = new File("out.txt");
		System.out.println(out.getAbsolutePath());
		
		if (!out.exists()) {
			out.createNewFile();
		}
		
		new demo89().test2(out);
	}
	
	/*向指定文件、指定位置插入内容*/
	public void test3(File out, long pos, String inContent) throws IOException {
		File tempFile = File.createTempFile(out.getName(), ".tmp", new File("."));
		tempFile.deleteOnExit();
		
		try(
				RandomAccessFile rf = new RandomAccessFile(tempFile, "rw");
				FileOutputStream otemp = new FileOutputStream(tempFile);
				FileInputStream itemp = new FileInputStream(tempFile); 
				){
			rf.seek(pos);
			
			byte[] buf = new byte[64];
			int hasRead = 0;
			
			/*读入临时文件*/
			while ((hasRead = rf.read(buf)) > 0) {
				otemp.write(buf, 0, hasRead);
			}
			
			/*在文件中插入内容*/
			rf.seek(pos);
			rf.write(inContent.getBytes());;
		}
	}	
	
	/*向指定文件追加内容*/
	public void test2(File out) throws IOException {
		RandomAccessFile rf = new RandomAccessFile(out, "rw");
		printFilePointer(rf);
		
		rf.seek(rf.length());
		rf.write("追加内容！\r\n".getBytes());
		rf.close();
	}
	
	/*从指定位置读取文件*/
	public void test1(File out) throws IOException {

		
		RandomAccessFile rf = new RandomAccessFile(out, "r");
		printFilePointer(rf);
		
		if (rf.length() <= 300) {
			System.out.println("[文件长度]" + rf.length());
			return; 
		}
		
		rf.seek(300);
		printFilePointer(rf);
		
		byte[] buff = new byte[300];
		int hasRead = 0;
		while ((hasRead = rf.read(buff)) > 0) {
			String sb = new String(buff, 0, hasRead);
			System.out.println("[Output]" + sb);
		}
		
		rf.close();
	}
	
	/*显示文件当前指针*/
	public void printFilePointer(RandomAccessFile rf) throws IOException {
		System.out.println("[文件指针初始位置]" + rf.getFilePointer());
	}
}
